<!DOCTYPE html>
<html lang="he" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>×ª×‘× ×™×ª ×”××¦××¤×“×™×” - ×œ××™×œ×•×™</title>
    <style>
        :root {
            --primary-color: #667eea;
            --secondary-color: #764ba2;
            --accent-color: #74b9ff;
        }

        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: linear-gradient(135deg, #f5f7fa 0%, #c3cfe2 100%);
            margin: 0;
            padding: 20px;
            line-height: 1.8;
        }

        .book-container {
            max-width: 800px;
            margin: 0 auto;
            background: white;
            border-radius: 15px;
            box-shadow: 0 10px 30px rgba(0,0,0,0.2);
            overflow: hidden;
        }

        .page {
            padding: 40px;
            min-height: 500px;
            border-bottom: 3px solid #eee;
            page-break-after: always;
        }

        .page:last-child {
            border-bottom: none;
        }

        /* ×“×£ ×‘×—×™×¨×ª ×¦×‘×¢×™× */
        .color-selection-page {
            background: linear-gradient(135deg, #ffecd2 0%, #fcb69f 100%);
            color: #2c3e50;
            text-align: center;
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
            min-height: 600px;
        }

        .color-selection-page h1 {
            font-size: 3em;
            margin-bottom: 20px;
            text-shadow: 2px 2px 4px rgba(0,0,0,0.1);
        }

        .color-selection-page .subtitle {
            font-size: 1.3em;
            margin-bottom: 40px;
            opacity: 0.8;
            max-width: 600px;
            line-height: 1.6;
        }

        .color-picker-section {
            background: rgba(255,255,255,0.9);
            padding: 30px;
            border-radius: 15px;
            backdrop-filter: blur(10px);
            width: 100%;
            max-width: 600px;
            box-shadow: 0 5px 20px rgba(0,0,0,0.1);
        }

        .color-picker-row {
            display: flex;
            align-items: center;
            margin: 20px 0;
            gap: 20px;
        }

        .color-picker-row label {
            font-weight: bold;
            min-width: 100px;
            font-size: 1.1em;
        }

        .color-input {
            width: 60px;
            height: 60px;
            border: 3px solid #ddd;
            border-radius: 50%;
            cursor: pointer;
            transition: all 0.3s;
        }

        .color-input:hover {
            transform: scale(1.1);
            border-color: #333;
        }

        .color-preview {
            flex: 1;
            height: 40px;
            border-radius: 20px;
            border: 2px solid rgba(0,0,0,0.1);
            display: flex;
            align-items: center;
            justify-content: center;
            font-weight: bold;
            color: white;
            text-shadow: 1px 1px 2px rgba(0,0,0,0.5);
        }

        .start-button {
            background: linear-gradient(135deg, #ff6b6b, #ee5a52);
            color: white;
            border: none;
            padding: 20px 40px;
            border-radius: 15px;
            font-size: 1.3em;
            cursor: pointer;
            margin-top: 30px;
            transition: all 0.3s;
            box-shadow: 0 5px 15px rgba(0,0,0,0.2);
            font-weight: bold;
        }

        .start-button:hover {
            transform: translateY(-3px);
            box-shadow: 0 8px 25px rgba(0,0,0,0.3);
        }

        .color-inspiration {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(150px, 1fr));
            gap: 15px;
            margin: 25px 0;
        }

        .inspiration-card {
            background: white;
            padding: 15px;
            border-radius: 10px;
            cursor: pointer;
            transition: all 0.3s;
            border: 2px solid transparent;
        }

        .inspiration-card:hover {
            transform: translateY(-3px);
            box-shadow: 0 5px 15px rgba(0,0,0,0.1);
            border-color: #333;
        }

        .inspiration-colors {
            display: flex;
            gap: 5px;
            margin-bottom: 10px;
        }

        .inspiration-color {
            width: 30px;
            height: 30px;
            border-radius: 50%;
            border: 1px solid rgba(0,0,0,0.1);
        }

        .inspiration-title {
            font-weight: bold;
            margin-bottom: 5px;
        }

        .inspiration-desc {
            font-size: 0.9em;
            color: #666;
        }

        .cover-page {
            background: linear-gradient(135deg, var(--primary-color) 0%, var(--secondary-color) 100%);
            color: white;
            text-align: center;
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
        }

        .cover-page h1 {
            font-size: 3em;
            margin-bottom: 20px;
            text-shadow: 2px 2px 4px rgba(0,0,0,0.3);
        }

        .cover-page .subtitle {
            font-size: 1.5em;
            margin-bottom: 30px;
            opacity: 0.9;
        }

        .info-form {
            background: rgba(255,255,255,0.1);
            padding: 25px;
            border-radius: 15px;
            backdrop-filter: blur(10px);
            width: 100%;
            max-width: 500px;
        }

        .chapter-title {
            color: var(--primary-color);
            font-size: 2.2em;
            margin-bottom: 25px;
            border-bottom: 3px solid var(--primary-color);
            padding-bottom: 10px;
        }

        .form-section {
            margin-bottom: 30px;
            padding: 20px;
            background: #f8f9fa;
            border-radius: 10px;
            border-right: 5px solid var(--primary-color);
        }

        .form-section h3 {
            color: var(--primary-color);
            margin-bottom: 15px;
            font-size: 1.3em;
        }

        .input-field {
            width: 100%;
            padding: 12px;
            margin: 10px 0;
            border: 2px solid #ddd;
            border-radius: 8px;
            font-size: 1em;
            font-family: inherit;
            transition: border-color 0.3s;
            box-sizing: border-box;
        }

        .input-field:focus {
            outline: none;
            border-color: var(--primary-color);
            box-shadow: 0 0 0 3px rgba(102, 126, 234, 0.1);
        }

        .text-area {
            min-height: 100px;
            resize: vertical;
        }

        .text-area-large {
            min-height: 150px;
        }

        .drawing-area {
            background: #ffffff;
            border: 3px solid var(--primary-color);
            border-radius: 15px;
            padding: 20px;
            text-align: center;
            margin: 25px 0;
            min-height: 400px;
            display: flex;
            align-items: stretch;
            justify-content: center;
            flex-direction: row;
            gap: 20px;
        }

        .drawing-canvas-container {
            flex: 1;
            display: flex;
            flex-direction: column;
            align-items: center;
        }

        .drawing-canvas {
            border: 2px solid #ddd;
            border-radius: 10px;
            cursor: crosshair;
            background: white;
            box-shadow: 0 2px 8px rgba(0,0,0,0.1);
        }

        .drawing-tools {
            display: flex;
            flex-direction: column;
            gap: 10px;
            padding: 15px;
            background: #f8f9fa;
            border-radius: 10px;
            border: 2px solid #ddd;
            min-width: 80px;
        }

        .color-tool {
            width: 50px;
            height: 50px;
            border-radius: 50%;
            border: 3px solid transparent;
            cursor: pointer;
            transition: all 0.3s;
            display: flex;
            align-items: center;
            justify-content: center;
            font-weight: bold;
            color: white;
            text-shadow: 1px 1px 2px rgba(0,0,0,0.5);
            font-size: 0.7em;
        }

        .color-tool:hover {
            transform: scale(1.1);
            border-color: #333;
        }

        .color-tool.active {
            border-color: #000;
            transform: scale(1.2);
        }

        .eraser-tool {
            width: 50px;
            height: 50px;
            background: #fff;
            border: 3px solid #333;
            border-radius: 10px;
            cursor: pointer;
            transition: all 0.3s;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 1.5em;
        }

        .eraser-tool:hover {
            transform: scale(1.1);
            background: #f0f0f0;
        }

        .eraser-tool.active {
            background: #e0e0e0;
            transform: scale(1.2);
        }

        .clear-button {
            width: 50px;
            height: 30px;
            background: #ff4757;
            color: white;
            border: none;
            border-radius: 5px;
            cursor: pointer;
            font-size: 0.8em;
            font-weight: bold;
        }

        .clear-button:hover {
            background: #ff3742;
        }

        .drawing-instructions {
            color: #666;
            font-size: 1em;
            line-height: 1.4;
            margin-bottom: 15px;
        }

        .parts-section {
            background: #f0f8ff;
            padding: 25px;
            border-radius: 15px;
            margin: 25px 0;
            border: 2px solid var(--primary-color);
        }

        .parts-list {
            list-style: none;
            padding: 0;
        }

        .parts-list li {
            background: white;
            margin: 15px 0;
            padding: 15px;
            border-radius: 8px;
            border-right: 4px solid var(--primary-color);
            display: flex;
            align-items: center;
            gap: 15px;
        }

        .parts-list li::before {
            content: "ğŸ”§";
            font-size: 1.2em;
            flex-shrink: 0;
        }

        .parts-input {
            flex: 1;
            border: 1px solid #ddd;
            border-radius: 5px;
            padding: 8px;
            font-size: 0.9em;
        }

        .tip-box {
            background: linear-gradient(135deg, #ffeaa7, #fab1a0);
            padding: 20px;
            border-radius: 10px;
            margin: 20px 0;
            border-right: 5px solid #e17055;
        }

        .tip-box h4 {
            margin: 0 0 10px 0;
            color: #2d3436;
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .tip-box h4::before {
            content: "ğŸ’¡";
            font-size: 1.3em;
        }

        .future-section {
            background: linear-gradient(135deg, var(--accent-color), var(--primary-color));
            color: white;
            padding: 25px;
            border-radius: 15px;
            margin: 25px 0;
        }

        .future-section h3 {
            color: white;
            margin-bottom: 20px;
        }

        .future-input {
            background: rgba(255,255,255,0.9);
            border: none;
            color: #333;
        }

        .checklist {
            background: #e8f5e8;
            padding: 20px;
            border-radius: 10px;
            margin: 20px 0;
            border: 2px solid #4caf50;
        }

        .checklist h4 {
            color: #2e7d32;
            margin-bottom: 15px;
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .checklist h4::before {
            content: "âœ“";
            background: #4caf50;
            color: white;
            border-radius: 50%;
            width: 25px;
            height: 25px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 0.8em;
        }
.navigation {
    text-align: center;
    margin: 20px 0;
    display: none; /* ×”×•×¡×£ ××ª ×”×©×•×¨×” ×”×–×• */
}

        .btn {
            background: linear-gradient(135deg, var(--primary-color), var(--secondary-color));
            color: white;
            border: none;
            padding: 15px 30px;
            border-radius: 10px;
            font-size: 1em;
            cursor: pointer;
            margin: 0 10px;
            transition: all 0.3s;
            box-shadow: 0 4px 15px rgba(0,0,0,0.2);
        }

        .btn:hover {
            transform: translateY(-3px);
            box-shadow: 0 6px 20px rgba(0,0,0,0.3);
        }

        .btn:disabled {
            opacity: 0.6;
            cursor: not-allowed;
            transform: none;
        }

        .hidden {
            display: none !important;
        }

@media print {
    .navigation { display: none; }
    .page { page-break-after: always; }
    body { background: white; direction: rtl; }
    .book-container { box-shadow: none; direction: rtl; }
    .color-selection-page { display: none; }
    * { direction: rtl !important; }
}
    </style>
</head>
<body>
    <div class="book-container">
        <!-- ×“×£ ×‘×—×™×¨×ª ×¦×‘×¢×™× -->
        <div class="page color-selection-page" id="colorSelectionPage">
            <h1>×‘×¨×•×›×™× ×”×‘××™× ×œ×”××¦××¤×“×™×”! ğŸ¨</h1>
            <div class="subtitle">
                ×œ×¤× ×™ ×©××ª×—×™×œ×™× -<br>
                ×‘×—×¨×• 3 ×¦×‘×¢×™× ×©×™×™×”×™×• ×”×‘×¡×™×¡ ×œ×¢×™×¦×•×‘ ×©×œ ×¡×¤×¨ ×”×¤×¨×•×™×§×˜ ×©×œ×›×.<br>
                ×ª×—×©×‘×• ×¢×œ ×¦×‘×¢×™× ×©××™×™×¦×’×™× ××ª ×”×”××¦××” ×©×œ×›× â€“ ××¦×—×™×§×™×? ×˜×›× ×•×œ×•×’×™×™×? ×˜×‘×¢×™×™×? ××¤×ª×™×¢×™×?
            </div>
            
            <div class="color-picker-section">
                <h3>×‘×—×¨×• ××ª ×”×¦×‘×¢×™× ×©×œ×›×:</h3>
                
                <div class="color-picker-row">
                    <label>×¦×‘×¢ 1:</label>
                    <input type="color" class="color-input" id="color1" value="#667eea" onchange="updateColorPreview(1)">
                    <div class="color-preview" id="preview1" style="background: #667eea;">×¦×‘×¢ ×¨××©×™</div>
                </div>
                
                <div class="color-picker-row">
                    <label>×¦×‘×¢ 2:</label>
                    <input type="color" class="color-input" id="color2" value="#764ba2" onchange="updateColorPreview(2)">
                    <div class="color-preview" id="preview2" style="background: #764ba2;">×¦×‘×¢ ××©× ×™</div>
                </div>
                
                <div class="color-picker-row">
                    <label>×¦×‘×¢ 3:</label>
                    <input type="color" class="color-input" id="color3" value="#74b9ff" onchange="updateColorPreview(3)">
                    <div class="color-preview" id="preview3" style="background: #74b9ff;">×¦×‘×¢ ×”×“×’×©×”</div>
                </div>

                <h4>××• ×‘×—×¨×• ××”×¨×¢×™×•× ×•×ª ×©×œ× ×•:</h4>
                <div class="color-inspiration">
                    <div class="inspiration-card" onclick="applyColorTheme('#e74c3c', '#c0392b', '#f39c12')">
                        <div class="inspiration-colors">
                            <div class="inspiration-color" style="background: #e74c3c;"></div>
                            <div class="inspiration-color" style="background: #c0392b;"></div>
                            <div class="inspiration-color" style="background: #f39c12;"></div>
                        </div>
                        <div class="inspiration-title">×× ×¨×’×˜×™</div>
                        <div class="inspiration-desc">××“×•×, ×‘×•×¨×“×• ×•×›×ª×•×</div>
                    </div>
                    
                    <div class="inspiration-card" onclick="applyColorTheme('#27ae60', '#16a085', '#2ecc71')">
                        <div class="inspiration-colors">
                            <div class="inspiration-color" style="background: #27ae60;"></div>
                            <div class="inspiration-color" style="background: #16a085;"></div>
                            <div class="inspiration-color" style="background: #2ecc71;"></div>
                        </div>
                        <div class="inspiration-title">×˜×‘×¢×™</div>
                        <div class="inspiration-desc">×™×¨×•×§, ×˜×•×¨×§×™×– ×•×¨×¢× ×Ÿ</div>
                    </div>
                    
                    <div class="inspiration-card" onclick="applyColorTheme('#8e44ad', '#9b59b6', '#e67e22')">
                        <div class="inspiration-colors">
                            <div class="inspiration-color" style="background: #8e44ad;"></div>
                            <div class="inspiration-color" style="background: #9b59b6;"></div>
                            <div class="inspiration-color" style="background: #e67e22;"></div>
                        </div>
                        <div class="inspiration-title">×™×¦×™×¨×ª×™</div>
                        <div class="inspiration-desc">×¡×’×•×œ, ×•×¨×•×“ ×•×›×ª×•×</div>
                    </div>
                    
                    <div class="inspiration-card" onclick="applyColorTheme('#34495e', '#2c3e50', '#3498db')">
                        <div class="inspiration-colors">
                            <div class="inspiration-color" style="background: #34495e;"></div>
                            <div class="inspiration-color" style="background: #2c3e50;"></div>
                            <div class="inspiration-color" style="background: #3498db;"></div>
                        </div>
                        <div class="inspiration-title">×˜×›× ×•×œ×•×’×™</div>
                        <div class="inspiration-desc">××¤×•×¨, ×›×”×” ×•×›×—×•×œ</div>
                    </div>
                </div>
                
                <button class="start-button" onclick="startInventopedia()">
                    ğŸš€ ×‘×•××• × ×ª×—×™×œ ×œ×™×¦×•×¨!
                </button>
            </div>
        </div>

        <!-- ×“×£ ×©×¢×¨ -->
        <div class="page cover-page hidden" id="page0">
            <h1>×”××¦××¤×“×™×”</h1>
            <div class="subtitle">×”××“×¨×™×š ×”×¡×•×“×™ ×©×œ ×›×œ ×××¦×™× ×¦×¢×™×¨</div>
            <div class="info-form">
                <input type="text" class="input-field" placeholder="×©× ×”×”××¦××” ×©×œ×›× (××©×”×• ×§×œ×™×˜ ×•××¢× ×™×™×Ÿ!)" style="font-size: 1.3em; font-weight: bold; text-align: center; margin-bottom: 20px;">
                <input type="text" class="input-field" placeholder="×©××•×ª ×”×××¦×™××™× (×›×œ ×”×—×‘×¨×™× ×‘×§×‘×•×¦×”)">
                <input type="text" class="input-field" placeholder="×ª××¨×™×š ×”×”××¦××”" value="29.05.2025" style="text-align: center;">
                <div style="margin-top: 20px; padding: 15px; background: rgba(255,255,255,0.1); border-radius: 10px; text-align: center;">
                    <strong>×¤×ª×¨×•×Ÿ ×™×¦×™×¨×ª×™ ×œ×‘×¢×™×™×ª ×¢×•××¡×™ ×ª× ×•×¢×”</strong><br>
                    ×”×××¦×™× ×”×¦×¢×™×¨ 2025
                </div>
            </div>
        </div>

        <!-- ×¤×¨×§ 1 -->
        <div class="page hidden" id="page1">
            <h2 class="chapter-title">×¤×¨×§ 1: ××” ×”×”××¦××” ×©×œ× ×•?</h2>
            
            <div class="tip-box">
                <h4>×˜×™×¤ ×œ×›×ª×™×‘×”</h4>
                <p>×”×¡×‘×™×¨×• ×›××™×œ×• ××ª× ××¡×¤×¨×™× ×œ×—×‘×¨ ×”×›×™ ×˜×•×‘ ×©×œ×›× - ×¤×©×•×˜, ×‘×¨×•×¨ ×•××¢× ×™×™×Ÿ!</p>
            </div>

            <div class="form-section">
                <h3>××” ×”×™× ×¢×•×©×”?</h3>
                <textarea class="input-field text-area-large" placeholder="×ª××¨×• ×‘××™×œ×™× ×¤×©×•×˜×•×ª ××” ×”×”××¦××” ×©×œ×›× ×¢×•×©×”. ×œ××©×œ: '×”×”××¦××” ×©×œ× ×• ×”×™× ××¢×¨×›×ª ×©××–×”×”...' ××• '×”×¨×—×¤×Ÿ ×©×œ× ×• ××‘×™×...'"></textarea>
            </div>

            <div class="form-section">
                <h3>××™×š ×”×™× ×¢×•×–×¨×ª ×œ× ×”×’×™×?</h3>
                <textarea class="input-field text-area" placeholder="××™×š ×”×”××¦××” ×©×œ×›× ×ª×¢×–×•×¨ ×œ×¤×ª×•×¨ ×‘×¢×™×•×ª ×©×œ × ×”×’×™×? ×œ××©×œ: ×¤×—×•×ª ×¤×§×§×™×, ×™×•×ª×¨ ×‘×˜×™×—×•×ª, ×—×™×¡×›×•×Ÿ ×‘×–××Ÿ..."></textarea>
            </div>

            <div class="form-section">
                <h3>×œ××” ×–×” ×—×©×•×‘?</h3>
                <textarea class="input-field text-area" placeholder="×œ××” ×”×¢×•×œ× ×¦×¨×™×š ××ª ×”×”××¦××” ×©×œ×›×? ××” ×™×”×™×” ×©×•× ×” ××—×¨×™ ×©×ª×××©×• ××•×ª×”?"></textarea>
            </div>
        </div>

        <!-- ×¤×¨×§ 2 -->
        <div class="page hidden" id="page2">
            <h2 class="chapter-title">×¤×¨×§ 2: ×××” ×”×”××¦××” ×‘× ×•×™×”?</h2>
            
            <div class="parts-section">
                <h3>×”×—×œ×§×™× ×”×¢×™×§×¨×™×™×:</h3>
                <ul class="parts-list">
                    <li><input type="text" class="parts-input" placeholder="×—×œ×§ ×¨××©×•×Ÿ (×œ××©×œ: ×—×™×™×©×Ÿ ×ª× ×•×¢×”)"> - <input type="text" class="parts-input" placeholder="××” ×”×•× ×¢×•×©×”?"></li>
                    <li><input type="text" class="parts-input" placeholder="×—×œ×§ ×©× ×™"> - <input type="text" class="parts-input" placeholder="××” ×”×•× ×¢×•×©×”?"></li>
                    <li><input type="text" class="parts-input" placeholder="×—×œ×§ ×©×œ×™×©×™"> - <input type="text" class="parts-input" placeholder="××” ×”×•× ×¢×•×©×”?"></li>
                    <li><input type="text" class="parts-input" placeholder="×—×œ×§ ×¨×‘×™×¢×™"> - <input type="text" class="parts-input" placeholder="××” ×”×•× ×¢×•×©×”?"></li>
                    <li><input type="text" class="parts-input" placeholder="×—×œ×§ ×—××™×©×™"> - <input type="text" class="parts-input" placeholder="××” ×”×•× ×¢×•×©×”?"></li>
                </ul>
            </div>

            <div class="form-section">
                <h3>×”×—×•××¨×™× ×©×‘×—×¨× ×•:</h3>
                <textarea class="input-field text-area" placeholder="×××™×œ×• ×—×•××¨×™× ×ª×‘× ×• ××ª ×”×”××¦××”? ×œ××©×œ: ××ª×›×ª, ×¤×œ×¡×˜×™×§, ×–×›×•×›×™×ª... ×•×œ××” ×‘×—×¨×ª× ×‘×—×•××¨×™× ×”××œ×”?"></textarea>
            </div>

            <div class="tip-box">
                <h4>×”×¨×›×™×‘ ×”×¡×•×“×™ ×©×œ×›×</h4>
                <textarea class="input-field text-area" placeholder="××” ×”×›×™ ××™×•×—×“ ×•×—×›× ×‘×”××¦××” ×©×œ×›×? ××” ×¢×•×©×” ××•×ª×” ×©×•× ×” ××›×œ ×“×‘×¨ ××—×¨?"></textarea>
            </div>
        </div>

        <!-- ×¤×¨×§ 3 -->
        <div class="page hidden" id="page3">
            <h2 class="chapter-title">×¤×¨×§ 3: ××™×š ×”×’×¢× ×• ×œ×¨×¢×™×•×Ÿ?</h2>
            
            <div class="form-section">
                <h3>×”×¡×™×¤×•×¨ ×©×”×ª×—×™×œ ×”×›×œ:</h3>
                <textarea class="input-field text-area-large" placeholder="×¡×¤×¨×• ××ª ×”×¡×™×¤×•×¨ - ××™×¤×” ×”×™×™×ª×? ××” ×§×¨×”? ××” ×’×¨× ×œ×›× ×œ×—×©×•×‘ ×¢×œ ×”×‘×¢×™×” ×”×–×•? ×”×™×• ×¡×¤×¦×™×¤×™×™× ×•××¢× ×™×™× ×™×!"></textarea>
            </div>

            <div class="tip-box">
                <h4>×”×¨×’×¢ ×©×œ ×”×”×©×¨××”</h4>
                <textarea class="input-field text-area" placeholder="××” ×”×™×” ×”×¨×’×¢ ×”×§×¡×•× ×©×‘×• ×××¨×ª× '×–×” ×–×”!'? ××™×š ×”×’×¢×ª× ×œ×¤×ª×¨×•×Ÿ ×”×¡×¤×¦×™×¤×™ ×”×–×”?"></textarea>
            </div>

            <div class="form-section">
                <h3>××™×š ×”××©×›× ×• ×œ×¤×ª×— ××ª ×”×¨×¢×™×•×Ÿ:</h3>
                <textarea class="input-field text-area" placeholder="××” ×¢×©×™×ª× ××—×¨×™ ×©×”×’×™×¢ ×œ×›× ×”×¨×¢×™×•×Ÿ? ××™×š ×—×§×¨×ª×? ×¢× ××™ ×“×™×‘×¨×ª×? ××” ×’×™×œ×™×ª×?"></textarea>
            </div>

            <div class="form-section">
                <h3>×œ××” ×”×”××¦××” ×”×–×• ×—×©×•×‘×” ×œ×›× ××™×©×™×ª?</h3>
                <textarea class="input-field text-area" placeholder="××” ×”××•×˜×™×‘×¦×™×” ×©×œ×›×? ×œ××” ×‘×—×¨×ª× ×œ×¤×ª×•×¨ ×‘×“×™×•×§ ××ª ×”×‘×¢×™×” ×”×–×•?"></textarea>
            </div>
        </div>

        <!-- ×¤×¨×§ 4 -->
        <div class="page hidden" id="page4">
            <h2 class="chapter-title">×¤×¨×§ 4: ××™×š ×–×” × ×¨××”?</h2>
            
            <div class="drawing-area">
                <div class="drawing-canvas-container">
                    <div class="drawing-instructions">
                        <h3>ğŸ¨ ×¦×™×™×¨×• ××ª ×”×”××¦××” ×©×œ×›× ×›××Ÿ</h3>
                        <p>×‘×—×¨×• ×¦×‘×¢ ××”×¦×“ ×•×¦×™×™×¨×•!</p>
                    </div>
                    <canvas id="drawingCanvas" class="drawing-canvas" width="500" height="300"></canvas>
                </div>
                
                <div class="drawing-tools">
                    <div class="color-tool" style="background: #000;" data-color="#000000" onclick="selectTool('pen', '#000000')">×©×—×•×¨</div>
                    <div class="color-tool drawing-color-1" onclick="selectDrawingColor(1)">×¦×‘×¢ 1</div>
                    <div class="color-tool drawing-color-2" onclick="selectDrawingColor(2)">×¦×‘×¢ 2</div>
                    <div class="color-tool drawing-color-3" onclick="selectDrawingColor(3)">×¦×‘×¢ 3</div>
                    <div class="color-tool" style="background: #2ecc71;" data-color="#2ecc71" onclick="selectTool('pen', '#2ecc71')">×™×¨×•×§</div>
                    <div class="eraser-tool" onclick="selectTool('eraser', '#ffffff')">ğŸ§¹</div>
                    <button class="clear-button" onclick="clearCanvas()">× ×§×”</button>
                </div>
            </div>

            <div class="form-section">
                <h3>×”×¡×‘×¨ ×¢×œ ×”×¦×™×•×¨:</h3>
                <textarea class="input-field text-area" placeholder="×”×¡×‘×™×¨×• ××” ×¨×•××™× ×‘×¦×™×•×¨. ×ª××¨×• ××ª ×”×—×œ×§×™× ×”×—×©×•×‘×™× ×•××™×š ×”× ×¢×•×‘×“×™× ×™×—×“."></textarea>
            </div>

            <div class="form-section">
                <h3>××™×š ×–×” ×¢×•×‘×“ ×‘×¤×•×¢×œ?</h3>
                <div style="margin-bottom: 15px;">
                    <input type="text" class="input-field" placeholder="×©×œ×‘ 1: ××” ×§×•×¨×” ×¨××©×•×Ÿ?">
                </div>
                <div style="margin-bottom: 15px;">
                    <input type="text" class="input-field" placeholder="×©×œ×‘ 2: ××” ×§×•×¨×” ××—×¨ ×›×š?">
                </div>
                <div style="margin-bottom: 15px;">
                    <input type="text" class="input-field" placeholder="×©×œ×‘ 3: ××™×š ×–×” ×××©×™×š?">
                </div>
                <div>
                    <input type="text" class="input-field" placeholder="×©×œ×‘ 4: ××” ×”×ª×•×¦××” ×”×¡×•×¤×™×ª?">
                </div>
            </div>
        </div>

        <!-- ×¤×¨×§ 5 -->
        <div class="page hidden" id="page5">
            <h2 class="chapter-title">×¤×¨×§ 5: ××” ××™×•×—×“ ×‘×”××¦××” ×©×œ× ×•?</h2>
            
            <div class="form-section">
                <h3>××” ×©×•× ×” ×‘×–×” ××›×œ ×“×‘×¨ ××—×¨?</h3>
                <textarea class="input-field text-area" placeholder="××™×š ×”×”××¦××” ×©×œ×›× ×©×•× ×” ×××” ×©×§×™×™× ×”×™×•×? ××” ×¢×•×©×” ××•×ª×” ××™×•×—×“×ª?"></textarea>
            </div>

            <div class="form-section">
                <h3>×”×©×•×•××” ×œ××” ×©×§×™×™× ×”×™×•×:</h3>
                <div style="margin-bottom: 15px;">
                    <label style="font-weight: bold;">×¤×ª×¨×•× ×•×ª ×¨×’×™×œ×™× ×”×™×•×:</label>
                    <textarea class="input-field text-area" placeholder="××™×š ×× ×©×™× ×¤×•×ª×¨×™× ××ª ×”×‘×¢×™×” ×”×–×• ×”×™×•×? ××” ×”×‘×¢×™×•×ª ×¢× ×”×¤×ª×¨×•× ×•×ª ×”×§×™×™××™×?"></textarea>
                </div>
                <div>
                    <label style="font-weight: bold;">×”×”××¦××” ×©×œ× ×•:</label>
                    <textarea class="input-field text-area" placeholder="×œ××” ×”×¤×ª×¨×•×Ÿ ×©×œ×›× ×˜×•×‘ ×™×•×ª×¨? ××” ×”×™×ª×¨×•× ×•×ª?"></textarea>
                </div>
            </div>

            <div class="tip-box">
                <h4>×”×“×‘×¨ ×”×›×™ ××™×•×—×“</h4>
                <textarea class="input-field text-area" placeholder="××” ×”×›×™ ×’×¨× ×“×™×•×–×™ ×•××¨×ª×§ ×‘×”××¦××” ×©×œ×›×? ××” ×™×’×¨×•× ×œ×× ×©×™× ×œ×•××¨ '×•×•××•!'?"></textarea>
            </div>

            <div class="form-section">
                <h3>×œ××” ×–×” ××”×¤×›× ×™?</h3>
                <textarea class="input-field text-area" placeholder="××™×š ×”×”××¦××” ×©×œ×›× ×ª×©× ×” ××ª ×”×¢×•×œ×? ××” ×™×”×™×” ××—×¨×ª ××—×¨×™ ×©×”×™× ×ª×ª×××©?"></textarea>
            </div>
        </div>

        <!-- ×¤×¨×§ 6 -->
        <div class="page hidden" id="page6">
            <h2 class="chapter-title">×¤×¨×§ 6: ××—×©×‘×•×ª ×œ×¢×ª×™×“</h2>
            
            <div class="future-section">
                <h3>×”×—×œ×•××•×ª ×©×œ× ×• - ××” × ×•×¡×™×£ ×¢× ×ª×§×¦×™×‘ ×¢× ×§ ×•×©× ×” × ×•×¡×¤×ª:</h3>
                <textarea class="input-field future-input text-area-large" placeholder="×× ×”×™×™×ª× ×™×›×•×œ×™× ×œ×©×“×¨×’ ××ª ×”×”××¦××” ×œ×œ× ×”×’×‘×œ×•×ª - ××” ×”×™×™×ª× ××•×¡×™×¤×™×? ×ª×—×œ××• ×‘×’×“×•×œ!"></textarea>
            </div>

            <div class="form-section">
                <h3>×©×“×¨×•×’×™× ×˜×›× ×™×™×:</h3>
                <textarea class="input-field text-area" placeholder="××™×–×” ×˜×›× ×•×œ×•×’×™×•×ª ×—×“×©×•×ª ×ª×•×¡×™×¤×•? ××” ×ª×©×¤×¨×•? ××™×š ×ª×¢×©×• ××ª ×–×” ×¢×•×“ ×™×•×ª×¨ ×—×›×?"></textarea>
            </div>

            <div class="form-section">
                <h3>×”×¨×—×‘×” ×œ×¢×•×œ×:</h3>
                <textarea class="input-field text-area" placeholder="××™×š ×ª×¤×™×¦×• ××ª ×”×”××¦××” ×œ×›×œ ×”×¢×•×œ×? ×‘××™×œ×• ××“×™× ×•×ª ×–×” ×™×¢×‘×•×“ ×”×›×™ ×˜×•×‘? ××™×š ×ª×ª××™××• ×œ×ª×¨×‘×•×™×•×ª ×©×•× ×•×ª?"></textarea>
            </div>

            <div class="tip-box">
                <h4>×”××˜×¨×” ×”×’×“×•×œ×”</h4>
                <textarea class="input-field text-area" placeholder="××” ×”×—×œ×•× ×”×’×“×•×œ ×©×œ×›×? ××™×š ×”×”××¦××” ×ª×¢×–×•×¨ ×œ×× ×©×™×? ××” ×”×©×™× ×•×™ ×©××ª× ×¨×•×¦×™× ×œ×¨××•×ª ×‘×¢×•×œ×?"></textarea>
            </div>

            <div class="form-section">
                <h3>××¡×¨ ×œ×¢×ª×™×“:</h3>
                <textarea class="input-field text-area" placeholder="××” ×”×™×™×ª× ×¨×•×¦×™× ×œ×•××¨ ×œ×¢×¦××›× ×‘×¢×•×“ 10 ×©× ×™×? ××™×–×” ××¡×¨ ×œ×¢×ª×™×“?"></textarea>
            </div>
        </div>

        <!-- ×¢××•×“ ×‘×“×™×§×” ××—×¨×•×Ÿ -->
        <div class="page hidden" id="finalPage">
            <h2 class="chapter-title">âœ“ ×‘×“×™×§×” ××—×¨×•× ×” ×œ×¤× ×™ ×”×”×’×©×”</h2>
            
            <div class="checklist">
                <h4>×¨×©×™××ª ×‘×“×™×§×” - ×•×“××• ×©×›×œ ×”×‘××™× ××•×¤×™×¢×™× ×‘×¡×¤×¨:</h4>
                <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 15px; margin-top: 15px;">
                    <div>
                        <label><input type="checkbox"> ×“×£ ×©×¢×¨ ×¢× ×›×œ ×”×¤×¨×˜×™×</label><br>
                        <label><input type="checkbox"> ×”×¡×‘×¨ ×‘×¨×•×¨ ××” ×”×”××¦××” ×¢×•×©×”</label><br>
                        <label><input type="checkbox"> ×¨×©×™××ª ×”×—×œ×§×™× ×•×”×—×•××¨×™×</label><br>
                        <label><input type="checkbox"> ×¡×™×¤×•×¨ ××™×š ×”×’×¢×ª× ×œ×¨×¢×™×•×Ÿ</label><br>
                    </div>
                    <div>
                        <label><input type="checkbox"> ×¦×™×•×¨ ××• ×ª×¨×©×™× ×©×œ ×”×”××¦××”</label><br>
                        <label><input type="checkbox"> ×”×¡×‘×¨ ×œ××” ×–×” ××™×•×—×“</label><br>
                        <label><input type="checkbox"> ×—×–×•×Ÿ ×œ×¢×ª×™×“</label><br>
                        <label><input type="checkbox"> ×”×›×œ ×›×ª×•×‘ ×‘×¦×•×¨×” ×‘×¨×•×¨×” ×•×§×¨×™××”</label><br>
                    </div>
                </div>
            </div>

            <div style="background: linear-gradient(135deg, #00b894, #00a085); color: white; padding: 25px; border-radius: 15px; text-align: center; margin: 30px 0;">
                <h2 style="margin: 0 0 15px 0; color: white;">ğŸ‰ ×›×œ ×”×›×‘×•×“! ğŸ‰</h2>
                <p style="font-size: 1.2em; margin: 0;">×¡×™×™××ª× ××ª ×”××¦××¤×“×™×” ×”×¨××©×•× ×” ×©×œ×›×!</p>
                <p style="margin: 10px 0 0 0;">×¢×›×©×™×• ××ª× ×××¦×™××™× ×¨×©××™×™× ×¢× ×¡×¤×¨ ×¤×¨×•×™×§×˜ ××§×¦×•×¢×™!</p>
            </div>

            <div style="border: 3px solid var(--primary-color); border-radius: 15px; padding: 20px; text-align: center;">
                <h3 style="color: var(--primary-color); margin-bottom: 15px;">×”×›× ×” ×œ×”×¦×’×”:</h3>
                <p>×›×¢×ª ×ª×•×›×œ×• ×œ×”×¦×™×’ ××ª ×”×”××¦××” ×©×œ×›× ×‘×¤× ×™ ×”×©×•×¤×˜×™×!</p>
                <p><strong>×–×›×¨×•:</strong> ×”××¦××¤×“×™×” ×”×–×• ×”×™× ×”×›×¨×˜×™×¡ ×‘×™×§×•×¨ ×©×œ ×”×”××¦××” ×©×œ×›×</p>
            </div>
        </div>
    </div>

    <div class="navigation">
        <button class="btn" onclick="downloadPDF()">ğŸ“¥ ×”×•×¨×“×”</button>
        <button class="btn" onclick="uploadToFirebase()">ğŸ”¥ ×©×œ×—×• ×œ×”×“×¤×¡×” (×—×•×‘×”!)</button>
    </div>

    <!-- Firebase SDKs -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/html2canvas/1.4.1/html2canvas.min.js"></script>
    <script type="module">
        // Import the functions you need from the SDKs you need
        import { initializeApp } from "https://www.gstatic.com/firebasejs/11.4.0/firebase-app.js";
        import { getStorage, ref, uploadBytesResumable, getDownloadURL } from "https://www.gstatic.com/firebasejs/11.4.0/firebase-storage.js";
        
        // Your web app's Firebase configuration
        const firebaseConfig = {
            apiKey: "AIzaSyCe24QH6BXEWtF2zJWcP8WhV8qKj-3l-00",
            authDomain: "gaash-2ea82.firebaseapp.com",
            projectId: "gaash-2ea82",
            storageBucket: "gaash-2ea82.firebasestorage.app",
            messagingSenderId: "1054252503536",
            appId: "1:1054252503536:web:4b7c546bd737de696e4d35"
        };

        // Initialize Firebase
        const app = initializeApp(firebaseConfig);
        const storage = getStorage(app);

        // Make Firebase functions available globally
        window.firebaseStorage = storage;
        window.firebaseRef = ref;
        window.firebaseUpload = uploadBytesResumable;
        window.firebaseGetDownloadURL = getDownloadURL;
    </script>

    <script>
        // ××©×ª× ×™× ×œ×¦×™×•×¨
        let canvas, ctx;
        let isDrawing = false;
        let currentTool = 'pen';
        let currentColor = '#000000';
        let currentSize = 3;
        let selectedColors = {
            color1: '#667eea',
            color2: '#764ba2',
            color3: '#74b9ff'
        };

        // ×¤×•× ×§×¦×™×•×ª ×œ×‘×—×™×¨×ª ×¦×‘×¢×™×
        function updateColorPreview(colorNum) {
            const colorInput = document.getElementById(`color${colorNum}`);
            const preview = document.getElementById(`preview${colorNum}`);
            const color = colorInput.value;
            
            preview.style.background = color;
            selectedColors[`color${colorNum}`] = color;
            
            // ×¢×“×›×•×Ÿ ×”×¦×‘×¢×™× ×‘×›×œ×™ ×”×¦×™×•×¨
            updateDrawingTools();
        }

        function applyColorTheme(color1, color2, color3) {
            document.getElementById('color1').value = color1;
            document.getElementById('color2').value = color2;
            document.getElementById('color3').value = color3;
            
            selectedColors.color1 = color1;
            selectedColors.color2 = color2;
            selectedColors.color3 = color3;
            
            updateColorPreview(1);
            updateColorPreview(2);
            updateColorPreview(3);
        }

        function updateDrawingTools() {
            const drawingColor1 = document.querySelector('.drawing-color-1');
            const drawingColor2 = document.querySelector('.drawing-color-2');
            const drawingColor3 = document.querySelector('.drawing-color-3');
            
            if (drawingColor1) {
                drawingColor1.style.background = selectedColors.color1;
                drawingColor1.setAttribute('data-color', selectedColors.color1);
            }
            if (drawingColor2) {
                drawingColor2.style.background = selectedColors.color2;
                drawingColor2.setAttribute('data-color', selectedColors.color2);
            }
            if (drawingColor3) {
                drawingColor3.style.background = selectedColors.color3;
                drawingColor3.setAttribute('data-color', selectedColors.color3);
            }
        }

        function selectDrawingColor(colorNum) {
            const color = selectedColors[`color${colorNum}`];
            selectTool('pen', color);
        }

        function startInventopedia() {
            // ×¢×“×›×•×Ÿ ××©×ª× ×™ CSS ×¢× ×”×¦×‘×¢×™× ×©× ×‘×—×¨×•
            document.documentElement.style.setProperty('--primary-color', selectedColors.color1);
            document.documentElement.style.setProperty('--secondary-color', selectedColors.color2);
            document.documentElement.style.setProperty('--accent-color', selectedColors.color3);
            
            // ×”×¡×ª×¨×ª ×“×£ ×‘×—×™×¨×ª ×”×¦×‘×¢×™× ×•×”×¦×’×ª ×”×¡×¤×¨
            document.getElementById('colorSelectionPage').classList.add('hidden');
            document.querySelectorAll('.page.hidden').forEach(page => {
                if (page.id !== 'colorSelectionPage') {
                    page.classList.remove('hidden');
                }
            });
            
            // ××ª×—×•×œ ×”×¦×™×•×¨ ×¢× ×”×¦×‘×¢×™× ×”×—×“×©×™×
            setTimeout(() => {
                initDrawing();
                updateDrawingTools();
                selectTool('pen', '#000000');
            }, 100);
            
            // ×©××™×¨×ª ×”×¦×‘×¢×™× ×‘-localStorage
            localStorage.setItem('inventopediaColors', JSON.stringify(selectedColors));
            document.querySelector('.navigation').style.display = 'block';

        }

        // ××ª×—×•×œ ×”×¦×™×•×¨
        function initDrawing() {
            canvas = document.getElementById('drawingCanvas');
            if (!canvas) return;
            
            ctx = canvas.getContext('2d');
            
            // ×”×’×“×¨×•×ª ×‘×¡×™×¡×™×•×ª
            ctx.lineCap = 'round';
            ctx.lineJoin = 'round';
            ctx.lineWidth = currentSize;
            
            // ××™×¨×•×¢×™ ×¢×›×‘×¨
            canvas.addEventListener('mousedown', startDrawing);
            canvas.addEventListener('mousemove', draw);
            canvas.addEventListener('mouseup', stopDrawing);
            canvas.addEventListener('mouseout', stopDrawing);
            
            // ××™×¨×•×¢×™ ××’×¢ (×œ×˜××‘×œ×˜×™×)
            canvas.addEventListener('touchstart', handleTouch);
            canvas.addEventListener('touchmove', handleTouch);
            canvas.addEventListener('touchend', stopDrawing);
        }

        function startDrawing(e) {
            isDrawing = true;
            const rect = canvas.getBoundingClientRect();
            const x = e.clientX - rect.left;
            const y = e.clientY - rect.top;
            
            ctx.beginPath();
            ctx.moveTo(x, y);
        }

        function draw(e) {
            if (!isDrawing) return;
            
            const rect = canvas.getBoundingClientRect();
            const x = e.clientX - rect.left;
            const y = e.clientY - rect.top;
            
            if (currentTool === 'eraser') {
                ctx.globalCompositeOperation = 'destination-out';
                ctx.lineWidth = 20;
            } else {
                ctx.globalCompositeOperation = 'source-over';
                ctx.strokeStyle = currentColor;
                ctx.lineWidth = currentSize;
            }
            
            ctx.lineTo(x, y);
            ctx.stroke();
        }

        function stopDrawing() {
            isDrawing = false;
            ctx.beginPath();
        }

        function handleTouch(e) {
            e.preventDefault();
            const touch = e.touches[0];
            const mouseEvent = new MouseEvent(e.type === 'touchstart' ? 'mousedown' : 
                                            e.type === 'touchmove' ? 'mousemove' : 'mouseup', {
                clientX: touch.clientX,
                clientY: touch.clientY
            });
            canvas.dispatchEvent(mouseEvent);
        }

        function selectTool(tool, color) {
            currentTool = tool;
            currentColor = color;
            
            // ×¢×“×›×•×Ÿ ×”×¢×™×¦×•×‘ ×©×œ ×”×›×œ×™×
            document.querySelectorAll('.color-tool, .eraser-tool').forEach(el => {
                el.classList.remove('active');
            });
            
            if (tool === 'eraser') {
                document.querySelector('.eraser-tool').classList.add('active');
            } else {
                const colorTool = document.querySelector(`[data-color="${color}"]`);
                if (colorTool) {
                    colorTool.classList.add('active');
                }
            }
        }

        function clearCanvas() {
            if (confirm('×”×× ××ª× ×‘×˜×•×—×™× ×©××ª× ×¨×•×¦×™× ×œ××—×•×§ ××ª ×›×œ ×”×¦×™×•×¨?')) {
                ctx.clearRect(0, 0, canvas.width, canvas.height);
            }
        }

        // ×©××™×¨×ª ×”×ª×§×“××•×ª ×¢× ×”×¦×™×•×¨ ×•×”×¦×‘×¢×™×
        function saveProgressSilent() {
            const inputs = document.querySelectorAll('input, textarea');
            const data = {
                colors: selectedColors,
                inputs: {}
            };
            
            inputs.forEach((input, index) => {
                data.inputs[index] = input.value;
            });
            
            // ×©××™×¨×ª ×”×¦×™×•×¨
            if (canvas) {
                data.drawing = canvas.toDataURL();
            }
            
            localStorage.setItem('inventionBook', JSON.stringify(data));
            console.log('×”×ª×§×“××•×ª × ×©××¨×” ××•×˜×•××˜×™×ª');
        }

        // ×©××™×¨×ª ×”×ª×§×“××•×ª ×¢× ×”×¦×™×•×¨ ×•×”×¦×‘×¢×™× (×¢× ×”×ª×¨××”)
        function saveProgress() {
            const inputs = document.querySelectorAll('input, textarea');
            const data = {
                colors: selectedColors,
                inputs: {}
            };
            
            inputs.forEach((input, index) => {
                data.inputs[index] = input.value;
            });
            
            // ×©××™×¨×ª ×”×¦×™×•×¨
            if (canvas) {
                data.drawing = canvas.toDataURL();
            }
            
            localStorage.setItem('inventionBook', JSON.stringify(data));
            alert('×”×”×ª×§×“××•×ª × ×©××¨×” ×‘×”×¦×œ×—×”! ğŸ’¾');
        }

        // ×˜×¢×™× ×ª ×”×ª×§×“××•×ª ×¢× ×”×¦×™×•×¨ ×•×”×¦×‘×¢×™×
        function loadProgress() {
            const savedData = localStorage.getItem('inventionBook');
            if (savedData) {
                const data = JSON.parse(savedData);
                
                // ×˜×¢×™× ×ª ×”×¦×‘×¢×™×
                if (data.colors) {
                    selectedColors = data.colors;
                    document.getElementById('color1').value = selectedColors.color1;
                    document.getElementById('color2').value = selectedColors.color2;
                    document.getElementById('color3').value = selectedColors.color3;
                    updateColorPreview(1);
                    updateColorPreview(2);
                    updateColorPreview(3);
                }
                
                // ×˜×¢×™× ×ª ×”×˜×§×¡×˜×™×
                if (data.inputs) {
                    const inputs = document.querySelectorAll('input, textarea');
                    inputs.forEach((input, index) => {
                        if (data.inputs[index]) {
                            input.value = data.inputs[index];
                        }
                    });
                }
                
                // ×˜×¢×™× ×ª ×”×¦×™×•×¨
                if (data.drawing && canvas) {
                    const img = new Image();
                    img.onload = function() {
                        ctx.clearRect(0, 0, canvas.width, canvas.height);
                        ctx.drawImage(img, 0, 0);
                    };
                    img.src = data.drawing;
                }
            }
        }

        // ×©××™×¨×” ××•×˜×•××˜×™×ª ×©×§×˜×” ×›×œ 30 ×©× ×™×•×ª
        setInterval(saveProgressSilent, 30000);

        // ×˜×¢×™× ×” ×‘×¢×ª ×¤×ª×™×—×ª ×”×“×£
        document.addEventListener('DOMContentLoaded', function() {
            // ×˜×¢×™× ×ª ×”×ª×§×“××•×ª
            loadProgress();
            
            // ×”×¡×¨×ª placeholder ×‘×¢×ª ×›×ª×™×‘×”
            const inputs = document.querySelectorAll('input, textarea');
            inputs.forEach(input => {
                input.addEventListener('focus', function() {
                    this.style.fontStyle = 'normal';
                });
            });
        });

        // ×”×•×¡×¤×ª ××“×“ ×”×ª×§×“××•×ª
        function updateProgressIndicator() {
            const inputs = document.querySelectorAll('input, textarea');
            const filledInputs = Array.from(inputs).filter(input => input.value.trim() !== '');
            const progress = Math.round((filledInputs.length / inputs.length) * 100);
            
            console.log(`×”×ª×§×“××•×ª: ${progress}% (${filledInputs.length}/${inputs.length} ×©×“×•×ª ××œ××™×)`);
        }

        // ×¢×“×›×•×Ÿ ×”×ª×§×“××•×ª ×‘×›×œ ×©×™× ×•×™
        document.addEventListener('input', updateProgressIndicator);

        // ×¤×•× ×§×¦×™×•×ª ×”×•×¨×“×” ×•×”×¢×œ××”
        async function downloadPDF() {
            try {
                // ×”×¡×ª×¨×ª ×“×£ ×‘×—×™×¨×ª ×”×¦×‘×¢×™× ×•×‘×¨ ×”× ×™×•×•×˜
                const colorPage = document.getElementById('colorSelectionPage');
                const navigation = document.querySelector('.navigation');
                const originalColorDisplay = colorPage.style.display;
                const originalNavDisplay = navigation.style.display;
                
                colorPage.style.display = 'none';
                navigation.style.display = 'none';
document.body.style.direction = 'rtl';
document.documentElement.style.direction = 'rtl';
const allElements = document.querySelectorAll('*');
allElements.forEach(el => {
    el.style.direction = 'rtl';
    el.style.textAlign = 'right';
});
                // ×™×¦×™×¨×ª PDF
                const { jsPDF } = window.jspdf;
                const pdf = new jsPDF({
                    orientation: 'portrait',
                    unit: 'mm',
                    format: 'a4'
                });

                // ×§×‘×œ×ª ×›×œ ×”×“×¤×™× (×œ××¢×˜ ×“×£ ×‘×—×™×¨×ª ×”×¦×‘×¢×™×)
                const pages = document.querySelectorAll('.page:not(#colorSelectionPage)');
                
                for (let i = 0; i < pages.length; i++) {
                    const page = pages[i];
                    
                    // ×”×¦×’×ª ×”×“×£ ×”× ×•×›×—×™
                    page.classList.remove('hidden');
                    
                    // ×”××ª× ×” ×§×¦×¨×” ×œ×¨×™× ×“×•×¨
                    await new Promise(resolve => setTimeout(resolve, 100));
                    
                    // ×™×¦×™×¨×ª ×ª××•× ×” ××”×“×£
const canvas = await html2canvas(page, {
    scale: 1,
    useCORS: true,
    allowTaint: false,
    backgroundColor: '#ffffff',
    width: page.offsetWidth,
    height: page.offsetHeight,
    logging: false
});
                    
                    const imgData = canvas.toDataURL('image/png');
                    
                    // ×”×•×¡×¤×ª ×“×£ ×—×“×© ×œ-PDF (×œ××¢×˜ ×”×“×£ ×”×¨××©×•×Ÿ)
                    if (i > 0) {
                        pdf.addPage();
                    }
                    
                    // ×”×•×¡×¤×ª ×”×ª××•× ×” ×œ-PDF
                    const pdfWidth = pdf.internal.pageSize.getWidth();
                    const pdfHeight = pdf.internal.pageSize.getHeight();
                    const imgWidth = canvas.width;
                    const imgHeight = canvas.height;
                    const ratio = Math.min(pdfWidth / imgWidth, pdfHeight / imgHeight);
                    const imgX = (pdfWidth - imgWidth * ratio) / 2;
                    const imgY = 0;
                    
                    pdf.addImage(imgData, 'JPEG', imgX, imgY, imgWidth * ratio, imgHeight * ratio);
                }

                // ×§×‘×œ×ª ×©× ×”×§×‘×•×¦×”
                const groupNameField = document.querySelector('input[placeholder*="×©××•×ª ×”×××¦×™××™×"]');
                const groupName = groupNameField ? groupNameField.value.trim() : '×”××¦××¤×“×™×”';
                const fileName = groupName || '×”××¦××¤×“×™×”';

                // ×”×•×¨×“×ª ×”-PDF
                pdf.save(`${fileName}.pdf`);

                // ×”×—×–×¨×ª ×”×ª×¦×•×’×” ×”××§×•×¨×™×ª
                colorPage.style.display = originalColorDisplay;
                navigation.style.display = originalNavDisplay;
                // ×”×—×–×¨×ª ×”×›×™×•×•×Ÿ ×”××§×•×¨×™
document.body.style.direction = '';
document.documentElement.style.direction = '';
allElements.forEach(el => {
    el.style.direction = '';
    el.style.textAlign = '';
});
                alert('×§×•×‘×¥ ×”-PDF ×”×•×¨×“ ×‘×”×¦×œ×—×”! ğŸ“¥');

            } catch (error) {
                console.error('×©×’×™××” ×‘×™×¦×™×¨×ª PDF:', error);
                alert('××™×¨×¢×” ×©×’×™××” ×‘×™×¦×™×¨×ª ×§×•×‘×¥ ×”-PDF. × ×¡×• ×©×•×‘.');
            }
        }

        async function uploadToFirebase() {
            try {
                // ×‘×“×™×§×” ×©×”×›×¤×ª×•×¨ ×–××™×Ÿ
                const uploadBtn = document.querySelector('button[onclick="uploadToFirebase()"]');
                uploadBtn.disabled = true;
                uploadBtn.innerHTML = 'â³ ×™×•×¦×¨ ×§×•×‘×¥...';

                // ×™×¦×™×¨×ª PDF ×›××• ×‘×¤×•× ×§×¦×™×” ×”×§×•×“××ª
                const colorPage = document.getElementById('colorSelectionPage');
                const navigation = document.querySelector('.navigation');
                const originalColorDisplay = colorPage.style.display;
                const originalNavDisplay = navigation.style.display;
                
                colorPage.style.display = 'none';
                navigation.style.display = 'none';
// ×›×¤×™×™×ª ×›×™×•×•×Ÿ RTL ×–×× ×™×ª
document.body.style.direction = 'rtl';
document.documentElement.style.direction = 'rtl';
const allElements = document.querySelectorAll('*');
allElements.forEach(el => {
    el.style.direction = 'rtl';
    el.style.textAlign = 'right';
});
                const { jsPDF } = window.jspdf;
                const pdf = new jsPDF({
                    orientation: 'portrait',
                    unit: 'mm',
                    format: 'a4'
                });

                const pages = document.querySelectorAll('.page:not(#colorSelectionPage)');
                
                for (let i = 0; i < pages.length; i++) {
                    const page = pages[i];
                    page.classList.remove('hidden');
                    await new Promise(resolve => setTimeout(resolve, 100));
                    
const canvas = await html2canvas(page, {
    scale: 1,
    useCORS: true,
    allowTaint: false,
    backgroundColor: '#ffffff',
    width: page.offsetWidth,
    height: page.offsetHeight,
    logging: false
});
                    
                    const imgData = canvas.toDataURL('image/jpeg', 0.8);
                    
                    if (i > 0) {
                        pdf.addPage();
                    }
                    
                    const pdfWidth = pdf.internal.pageSize.getWidth();
                    const pdfHeight = pdf.internal.pageSize.getHeight();
                    const imgWidth = canvas.width;
                    const imgHeight = canvas.height;
                    const ratio = Math.min(pdfWidth / imgWidth, pdfHeight / imgHeight);
                    const imgX = (pdfWidth - imgWidth * ratio) / 2;
                    const imgY = 0;
                    
                    pdf.addImage(imgData, 'JPEG', imgX, imgY, imgWidth * ratio, imgHeight * ratio);
                }

                // ×”×—×–×¨×ª ×”×ª×¦×•×’×” ×”××§×•×¨×™×ª
                colorPage.style.display = originalColorDisplay;
                navigation.style.display = originalNavDisplay;
// ×”×—×–×¨×ª ×”×›×™×•×•×Ÿ ×”××§×•×¨×™
document.body.style.direction = '';
document.documentElement.style.direction = '';
allElements.forEach(el => {
    el.style.direction = '';
    el.style.textAlign = '';
});
                // ×§×‘×œ×ª ×©× ×”×§×‘×•×¦×”
                const groupNameField = document.querySelector('input[placeholder*="×©××•×ª ×”×××¦×™××™×"]');
                const groupName = groupNameField ? groupNameField.value.trim() : '×”××¦××¤×“×™×”';
                const fileName = groupName || `×”××¦××¤×“×™×”_${Date.now()}`;

                // ×”××¨×ª PDF ×œ×‘×™×™×˜×™×
                const pdfBlob = pdf.output('blob');
                
                uploadBtn.innerHTML = 'â¬†ï¸ ××¢×œ×” ×œ×¢× ×Ÿ...';

                // ×”×¢×œ××” ×œ-Firebase Storage
                const storageRef = window.firebaseRef(window.firebaseStorage, `books/${fileName}.pdf`);
                const uploadTask = window.firebaseUpload(storageRef, pdfBlob);

                uploadTask.on('state_changed', 
                    (snapshot) => {
                        const progress = (snapshot.bytesTransferred / snapshot.totalBytes) * 100;
                        uploadBtn.innerHTML = `â¬†ï¸ ××¢×œ×”... ${Math.round(progress)}%`;
                    }, 
                    (error) => {
                        console.error('×©×’×™××” ×‘×”×¢×œ××”:', error);
                        alert('×©×’×™××” ×‘×”×¢×œ××” ×œ×¢× ×Ÿ. × ×¡×• ×©×•×‘.');
                        uploadBtn.disabled = false;
                        uploadBtn.innerHTML = 'ğŸ”¥ ×©×œ×—×• ×œ×”×“×¤×¡×”';
                    }, 
                    async () => {
                        try {
                            const downloadURL = await window.firebaseGetDownloadURL(uploadTask.snapshot.ref);
                            console.log('×§×•×‘×¥ ×”×•×¢×œ×” ×‘×”×¦×œ×—×”:', downloadURL);
                            
                            uploadBtn.innerHTML = 'âœ… × ×©×œ×— ×‘×”×¦×œ×—×”!';
                            alert('×”×§×•×‘×¥ × ×©×œ×— ×‘×”×¦×œ×—×” ×œ×”×“×¤×¡×”! ğŸ‰');
                            
                            setTimeout(() => {
                                uploadBtn.disabled = false;
                                uploadBtn.innerHTML = 'ğŸ”¥ ×©×œ×—×• ×œ×”×“×¤×¡×”';
                            }, 3000);
                        } catch (error) {
                            console.error('×©×’×™××” ×‘×§×‘×œ×ª URL:', error);
                            alert('×”×§×•×‘×¥ ×”×•×¢×œ×” ××š ×™×© ×‘×¢×™×” ×‘×§×™×©×•×¨.');
                            uploadBtn.disabled = false;
                            uploadBtn.innerHTML = 'ğŸ”¥ ×©×œ×—×• ×œ×”×“×¤×¡×”';
                        }
                    }
                );

            } catch (error) {
                console.error('×©×’×™××” ×›×œ×œ×™×ª:', error);
                alert('××™×¨×¢×” ×©×’×™××”. × ×¡×• ×©×•×‘.');
                const uploadBtn = document.querySelector('button[onclick="uploadToFirebase()"]');
                uploadBtn.disabled = false;
                uploadBtn.innerHTML = 'ğŸ”¥ ×©×œ×—×• ×œ×”×“×¤×¡×”';
            }
        }

        // ×”×¤×™×›×ª ×”×¤×•× ×§×¦×™×•×ª ×œ×’×œ×•×‘×œ×™×•×ª
        window.downloadPDF = downloadPDF;
        window.uploadToFirebase = uploadToFirebase;
    </script>
</body>
</html>
